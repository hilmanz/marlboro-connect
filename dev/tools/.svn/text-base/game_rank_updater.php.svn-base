<?php/**bot untuk mengupdate User rank setiap 1 jam sekali.**/include_once "config.inc.php";$SLEEP_TIME = 60*60;//DATABASE CONFIGURATIONS$host = $CONFIG['DATABASE'][0]['HOST'];$user = $CONFIG['DATABASE'][0]['USERNAME'];$password = $CONFIG['DATABASE'][0]['PASSWORD'];$db = $CONFIG['DATABASE'][0]['DATABASE'];$conn = mysql_connect($host,$user,$password);$game_id = 1;if($conn){    print "CONNECTION ESTABLISHED\n";}else{    print "CONNECTION FAILED\n";}if($conn){while(1){            if($game_id>4){            print "reset user rank : ";            $game_id = 1;            $sql = "TRUNCATE TABLE marlboro_connect.user_rank";            mysql_query($sql,$conn);            $sql = "INSERT INTO marlboro_connect.user_rank(user_id,score)                     SELECT user_id,total_score                     FROM (SELECT user_id,SUM(score) total_score FROM marlboro_connect.game_highscore                    GROUP BY user_id) a                    ORDER BY a.total_score DESC                    ";            mysql_query($sql,$conn);            print "done\n";            print "COMPLETED\n---------------------------\n";            break;        }        print "reset game high score for game #".$game_id." : ";        $sql = "DELETE FROM marlboro_connect.game_highscore WHERE game_id=".$game_id;        //print "\n".$sql."\n";        mysql_query($sql,$conn);                $sql = "INSERT INTO marlboro_connect.game_highscore(user_id,game_id,level,score,play_time)                SELECT user_id,game_id,level,MAX(score) as score,COUNT(user_id) as play_time FROM marlboro_connect.social_game                WHERE game_id=".$game_id."                GROUP BY user_id,level";        //print "\n".$sql."\n";                mysql_query($sql,$conn);        //print mysql_error()."\n";        print "done\n";        $game_id++;                        }}if($conn){	mysql_close($conn);	print "Closing Database Connection\n";}?>